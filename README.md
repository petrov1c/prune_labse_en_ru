## Прунинг LaBSE-en-ru

Будем уменьшать и ускорять LaBSE-en-ru

Уменьшать будем путем прунинга, после чего дообучим полученную сеть методом дистилляции

```
Прунинг - это удаление определенных частей модели (подрезание)
Дистилляция - это процесс передачи знаний от учителя к ученику
```

Прунинг можно воспринимать как правильную инициализацию сети ученика. Есть работы, показывающие,
что прунингом можно достичь лучшего результата, чем просто взяв сеть меньшего размера и дообучив её
 


### Данные

Для обучения используется корпус парных предложений https://translate.yandex.ru/corpus. 

### Настройка окружения

1. Создание
    ```
    python3 -m venv /path/to/new/virtual/environment
    source /path/to/new/virtual/environment/bin/activate
    ```

2. Установка зависимостей

    ```
    make install
    ```

3. Настройка ClearML

   - Регистрируемся в [ClearML](https://app.community.clear.ml/), если ещё нет аккаунта.
   - [в своем профиле ClearML](https://app.community.clear.ml/profile) нажимаем "Create new credentials"
   - в консоли пишем `clearml-init` и следуем инструкциям


### Запуск пайплайна
```
make train
```

### Просмотр экспериментов
   -  Локально в папке **experiments** лежат чекпойнты лучших моделей
   -  В [ClearML](https://app.clear.ml/projects/8a15381deb0d41429e451070a014c1a3)

### Проверка качества эмбеддингов на бейчмарке encedechka
```
make infer - для запуска в терминальном режиме
notebooks/encodechka_evaluation_2024.ipynb - jupyter блокнот 
```
